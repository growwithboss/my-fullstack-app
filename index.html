async function askBOSS() {
    const input = document.getElementById('userInput').value;
    const textOutput = document.getElementById('textOutput');
    const imgOutput = document.getElementById('imageOutput');
    const btn = document.getElementById('runBtn');
    
    if(!input) return;
    
    // 1. Reset the UI for a new request
    btn.disabled = true;
    textOutput.style.display = 'block';
    textOutput.innerText = "BOSSai is designing your image...";
    imgOutput.style.display = 'none';

    if (mode === 'image') {
        try {
            // 2. Clean the input and add a random seed to prevent caching
            const cleanPrompt = encodeURIComponent(input.trim());
            const randomSeed = Math.floor(Math.random() * 1000000);
            
            // 3. Construct the verified Pollinations URL
            const imageUrl = `https://image.pollinations.ai/prompt/${cleanPrompt}?width=1024&height=1024&seed=${randomSeed}&nologo=true`;

            // 4. Pre-load the image in the background before showing it
            const tempImage = new Image();
            tempImage.onload = function() {
                imgOutput.src = imageUrl;
                imgOutput.style.display = 'block';
                textOutput.style.display = 'none';
                btn.disabled = false;
            };
            
            tempImage.onerror = function() {
                textOutput.innerText = "BOSSai encountered a generation error. Please try a simpler prompt.";
                btn.disabled = false;
            };

            tempImage.src = imageUrl;

        } catch (err) {
            textOutput.innerText = "Critical error in Image Studio.";
            btn.disabled = false;
        }
    } else {
        // ... (Keep your existing Email/Code/Excel logic here)
    }
}
